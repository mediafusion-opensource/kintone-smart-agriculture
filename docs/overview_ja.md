# スマート農業プロジェクト概要 (kintone)

## はじめに

**スマート農業**プロジェクトは、kintoneプラットフォーム上に構築された農業管理システムで、計画、栽培、収穫から販売、会計まで、農業活動の包括的な管理をサポートするテンプレートとアプリケーションを提供します。

本システムは、Media Fusion Co.,Ltd.による社会貢献活動として、中小規模の農業事業者に無償で提供されています。

## プロジェクト構成

プロジェクトは以下の主要ディレクトリで構成されています：

```
kintone-smart-agriculture/
├── space/              # kintoneスペース用テンプレート
├── apps/               # kintoneアプリケーション
├── docs/               # プロジェクトドキュメント
└── README.md           # メインドキュメント
```

---

## `space/` ディレクトリ

### 目的

`space`ディレクトリには、プロジェクト内のすべてのアプリケーションを含む**kintoneスペーステンプレートファイル**（`.sptpl`）が含まれています。このテンプレートファイルを使用すると、すべてのアプリケーションとそれらの間のリンク（ルックアップ）を含む、kintoneスペース全体を一度にインポートできます。

### スペーステンプレートファイルが必要な理由

**アプリケーションを個別にインポートする場合の問題：**
- 各アプリケーションのZIPテンプレートファイルには、リンクしている参照アプリケーション（アプリ参照）も含まれています
- アプリケーションを1つずつインポートすると、参照アプリケーションが複数回インポートされ、**重複**が発生します
- これによりエラーが発生し、アプリケーション管理が複雑になります

**解決策 - スペーステンプレートファイルの使用：**
- `.sptpl`ファイルには、統一された構造でプロジェクトのすべてのアプリケーションが含まれています
- 一度のインポートで、すべてのアプリケーションを含むスペース全体を作成できます
- 参照アプリケーションの重複を回避できます
- アプリケーション間のリンク（ルックアップ）が最初から正確に設定されます

### 構成

```
space/
├── スマート農業労務会計システム.sptpl    # スペーステンプレートファイル（必須）
└── source/                              # ポータルカスタマイズ用JavaScriptファイル
    ├── jquery_3.3.1_jquery.min.js      # jQueryライブラリ
    ├── smart-agri-mobile-portal.js     # モバイル用カスタムスクリプト
    └── smart-agri-pc-portal.js         # PC用カスタムスクリプト
```

### 使用方法

#### ステップ1：スペーステンプレートのインポート（必須）

1. 管理者権限でkintoneにログイン
2. **スペース管理** → **スペースのインポート**に移動
3. `space/`ディレクトリから`スマート農業労務会計システム.sptpl`ファイルをアップロード
4. kintoneは自動的に新しいスペースを作成します：
   - プロジェクト内のすべてのアプリケーション（18アプリ）
   - アプリケーション間のリンク（ルックアップ）が事前設定済み
   - 基本的なスペース構造とアクセス権限

#### ステップ2：ポータルのカスタマイズ（オプション）

スペースをインポート後、JavaScriptファイルをアップロードしてポータルインターフェースをカスタマイズできます：

1. **JavaScriptとCSSのカスタマイズにアクセス**
   - 管理者権限でkintoneにログイン
   - **kintone管理** → **JavaScriptとCSSのカスタマイズ**に移動
   - ステップ1でインポートしたスペースを選択

2. **カスタマイズの適用範囲を設定**
   - 適用範囲を選択：
     - **"すべてのユーザーに適用"**：すべてのユーザーに適用（推奨）
     - **"kintone管理者のみに適用"**：管理者のみに適用
     - **"無効"**：カスタマイズを無効化

3. **PC用JavaScriptファイルのアップロード**
   - **"PC用JavaScriptファイルのアップロード"**セクションで、**"ファイルを追加"**をクリック
   - 以下の順序でファイルをアップロード（重要：正しい順序でアップロードする必要があります）：
     1. `jquery_3.3.1_jquery.min.js` (85 KB) - jQueryライブラリ（最初にアップロードする必要があります）
     2. `smart-agri-pc-portal.js` (6 KB) - PC用カスタムスクリプト
   - 必要に応じて上下矢印を使用してファイルの順序を調整
   - 注意：ファイルの順序は非常に重要です。jQueryは他のスクリプトより前に読み込む必要があります

4. **モバイルデバイス用JavaScriptファイルのアップロード**
   - **"モバイルデバイス用JavaScriptファイルのアップロード"**セクションで、**"ファイルを追加"**をクリック
   - 以下の順序でファイルをアップロード：
     1. `jquery_3.3.1_jquery.min.js` (85 KB) - jQueryライブラリ（最初にアップロードする必要があります）
     2. `smart-agri-mobile-portal.js` (4 KB) - モバイル用カスタムスクリプト
   - 必要に応じて上下矢印を使用してファイルの順序を調整

5. **設定を保存**
   - **"保存"**をクリックして変更を保存
   - スクリプトは自動的に有効化され、スペースに適用されます

**アップロード構成：**
```
JavaScriptとCSSのカスタマイズ
├── カスタマイズの適用範囲: "すべてのユーザーに適用"
├── PC用JavaScriptファイルのアップロード
│   ├── 1. jquery_3.3.1_jquery.min.js (85 KB)
│   └── 2. smart-agri-pc-portal.js (6 KB)
└── モバイルデバイス用JavaScriptファイルのアップロード
    ├── 1. jquery_3.3.1_jquery.min.js (85 KB)
    └── 2. smart-agri-mobile-portal.js (4 KB)
```

これらのJavaScriptファイルは、モバイルデバイスとコンピューターの両方に最適化されたプロフェッショナルなポータルインターフェースを提供し、ユーザーがシステム内のアプリケーションに簡単にアクセスして使用できるようにします。

### 重要な注意事項

⚠️ システム全体を使用する場合は、`apps/`ディレクトリから個別のアプリケーションをインポート**しないでください**。アプリケーションの重複が発生します。

✅ `.sptpl`ファイルを使用してスペース全体を一度にインポートすることを**推奨します**。システムが正確に動作することを保証します。

---

## `apps/` ディレクトリ

### 目的

`apps`ディレクトリには、プロジェクト内のすべてのkintoneアプリケーションが含まれています。各アプリケーションは、ZIPテンプレートファイルと、展開された内容を含むsourceディレクトリを含む別のディレクトリに整理されています。

### 構成

各アプリケーションは以下の構造を持っています：

```
apps/
└── [アプリケーション名]/
    ├── README.md                    # アプリケーションドキュメント
    ├── [アプリケーション名].zip       # kintoneにインポートするZIPテンプレートファイル
    └── source/                      # ZIPファイルの展開された内容
        ├── template.json            # アプリケーションのメイン設定ファイル
        ├── icon                     # アプリケーションアイコン
        ├── signature                # デジタル署名
        ├── appicon01, appicon02...  # カスタムアイコン
        ├── appjs01_DESKTOP_1...     # デスクトップ用JavaScriptファイル
        ├── appjs01_MOBILE_1...      # モバイル用JavaScriptファイル
        └── appjs01_DESKTOP_CSS_1... # カスタムCSSファイル
```

### アプリケーション一覧

プロジェクトには以下のアプリケーションが含まれています：

#### 1. **マスター管理**
- **圃場マスター管理** - 栽培エリア情報の管理
- **品種マスター管理** - 作物品種の管理
- **商品マスター管理** - 商品カタログの管理
- **作業マスター管理** - 作業タイプの管理
- **作業者マスター管理** - 作業者情報の管理
- **販売先マスター管理** - 顧客情報の管理
- **休憩マスター管理** - 休憩時間の管理

#### 2. **作付管理**
- **作付管理** - 作付計画と実績の管理
- **作付別人件費配賦** - 作付別の労務費の計算と配賦

#### 3. **生産管理**
- **収穫管理** - 収穫量の記録と管理
- **選別管理** - 製品選別プロセスの管理
- **在庫管理** - 製品在庫の管理

#### 4. **販売管理**
- **見積管理** - 顧客見積の管理
- **注文管理** - 注文の管理
- **出荷・納品** - 出荷と配送の管理
- **売上・請求・回収** - 売上、請求、回収の管理

#### 5. **人事管理**
- **計画・勤怠** - 作業計画と勤怠の管理

### 使用方法

#### ⚠️ インポートに関する重要な注意事項

**システム全体をインポートする場合：**
- ✅ `space/`ディレクトリ内の**スペーステンプレートファイル**（`.sptpl`）を使用 - これが推奨方法です
- `.sptpl`ファイルにはすべてのアプリケーションが含まれ、アプリ参照の重複を回避します

**個別のアプリケーションをインポートする場合：**
- システム全体ではなく、特定のアプリケーションのみが必要な場合
- スペースに追加する前にアプリケーションをカスタマイズしたい場合

#### 個別アプリケーションのインポート（必要な場合）

1. **ZIPファイルの使用**
   - kintone管理 → アプリ管理に移動
   - **"アプリを作成"**を選択
   - **"フォームテンプレートファイルから作成"**を選択
   - アプリケーションディレクトリから`[アプリケーション名].zip`ファイルをアップロード
   - kintoneは完全な設定でアプリケーションを自動的に作成します
   - ⚠️ 注意：参照アプリケーションの重複が発生する可能性があります

#### カスタマイズ内容のプレビュー

- 各アプリケーションの`source/`ディレクトリを開く
- `template.json`ファイルを表示してデータ構造を理解する
- JavaScriptファイルを表示してカスタムロジックを理解する
- CSSファイルを表示してカスタムインターフェースを理解する

#### `source/`ディレクトリ内のコンポーネント

- **template.json**：アプリケーションに関するすべての情報を含むメイン設定ファイル：
  - フォーム構造（データフィールド）
  - ビュー設定（表示モード）
  - ワークフロー設定（承認プロセス）
  - ルックアップ設定（アプリケーション間のリンク）
  - JavaScriptファイル設定

- **appjs*_DESKTOP_* / appjs*_MOBILE_***：各画面とデバイス用のカスタムJavaScriptファイル
  - デスクトップ：大画面に最適化
  - モバイル：モバイルデバイスに最適化

- **appjs*_DESKTOP_CSS_***：インターフェースを変更するカスタムCSSファイル

- **appicon***：アプリケーション用のカスタムアイコン

- **icon**：メインアプリケーションアイコン

- **signature**：アプリケーションを認証するデジタル署名

---

## システムの主な機能

### 1. 包括的な管理
- 計画から販売までの管理
- 人事と会計管理の統合
- コストと収益の追跡

### 2. モバイル最適化
- モバイル用レスポンシブインターフェース
- 現場からの直接データ入力
- リアルタイムデータ同期

### 3. Microsoft 365統合
- SharePointとのデータ同期
- 分析用Power BI
- その他のMS365アプリケーションとの統合

### 4. 柔軟なカスタマイズ
- すべてのカスタムソースコードが`source/`ディレクトリで利用可能
- 編集と拡張が容易
- 多言語サポート

---

## はじめに

### システム要件

- kintoneアカウント（スタンダードコース以上を推奨）
- Microsoft 365アカウント（SharePoint統合機能を使用する場合）

### 導入プロセス

1. **スペーステンプレートのインポート（必須）**
   - `space/`ディレクトリ内の`スマート農業労務会計システム.sptpl`ファイルを使用
   - kintoneにインポートして、すべてのアプリケーションを含むスペース全体を作成
   - アプリケーション間のリンク（ルックアップ）が事前設定済み

2. **ポータルのカスタマイズ（オプション）**
   - **kintone管理** → **JavaScriptとCSSのカスタマイズ**に移動
   - インポートしたスペースを選択
   - `space/source/`ディレクトリからJavaScriptファイルをアップロード：
     - PC用：`jquery_3.3.1_jquery.min.js`（最初）、`smart-agri-pc-portal.js`（2番目）
     - モバイル用：`jquery_3.3.1_jquery.min.js`（最初）、`smart-agri-mobile-portal.js`（2番目）
   - 設定を保存してカスタムポータルを有効化

3. **追加設定**
   - 各アプリケーションのアクセス権限を設定
   - 必要に応じてワークフローを設定
   - 通知とリマインダーを設定

4. **アプリケーションのカスタマイズ（オプション）**
   - `apps/[アプリケーション名]/source/`ディレクトリ内のファイルを表示して構造を理解
   - 特定のニーズに応じて編集
   - テストと展開

---

## 重要な注意事項

### スペーステンプレートファイル（.sptpl）について

- **`.sptpl`ファイル**：プロジェクトのすべてのアプリケーションを含むスペーステンプレートファイル
  - システム全体を一度にインポートするために**推奨**
  - 参照アプリケーション（アプリ参照）の重複を回避
  - アプリケーション間のリンク（ルックアップ）が正確に設定されることを保証
  - `space/`ディレクトリ内にあります

### ZIPファイルとsourceディレクトリについて

- **ZIPファイル**：kintoneに個別のアプリケーションをインポートするために使用
  - 特定のアプリケーションをいくつかインポートする場合にのみ使用すべき
  - リンクされた複数のアプリケーションをインポートすると、アプリ参照の重複が発生する可能性があります
  - スペースに追加する前に各アプリケーションをカスタマイズしたいユーザーに適しています

- **sourceディレクトリ**：展開されたすべての内容を含み、以下を可能にします：
  - すべてのカスタマイズファイルのプレビュー
  - アプリケーション構造とロジックの理解
  - 必要に応じて編集とカスタマイズ
  - kintoneのカスタマイズ方法の学習

### ライセンスについて

- プロジェクトは農業目的で無償提供されています
- "Powered by Media Fusion Co.,Ltd."の表示が必要です
- 商用利用または再配布の前に許可が必要です

---

## 参考資料

- **README.md**：プロジェクトのメインドキュメント（日本語/英語）
- **apps/[アプリケーション名]/README.md**：各アプリケーションの詳細ドキュメント
- **LICENSE.txt**：利用規約とライセンス

---

## サポート

技術サポートまたは導入相談については、以下にお問い合わせください：

**Media Fusion Co.,Ltd.**
- ウェブサイト: https://www.mediafusion.co.jp/

---

*このドキュメントは最終更新日: 2025-12-24*

